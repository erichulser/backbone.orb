!function t(e,o,n){function i(s,u){if(!o[s]){if(!e[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(r)return r(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var l=o[s]={exports:{}};e[s][0].call(l.exports,function(t){var o=e[s][1][t];return i(o?o:t)},l,l.exports,t,e,o,n)}return o[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,o){window.orb={},t("./queries.js"),t("./recordset.js"),t("./schema.js"),t("./models.js")},{"./models.js":2,"./queries.js":3,"./recordset.js":4,"./schema.js":5}],2:[function(t,e,o){!function(t,e){t.Model=Backbone.Model.extend({schema:void 0,initialize:function(t){if(this.schema){var e={};_.each(this.schema.columns||[],function(t){void 0!==t["default"]&&(e[t.field]=t["default"])}),t=_.extend(e,t)}Backbone.Model.prototype.initialize.call(this,t)},addCollection:function(t,e,o){o=o||{};var n=this,i=e.select();return o.urlRoot?i.urlRoot=o.urlRoot:i.urlRoot=function(){return s.rtrim(n.urlRoot,"/")+"/"+n.get("id")+"/"+(o.urlSuffix||t)},this[t]=i,i},addReference:function(t,e,o){o=o||{};var n=this,i=o.getter||"get"+t[0].toUpperCase()+t.slice(1),r=o.setter||"set"+t[0].toUpperCase()+t.slice(1),u=o.field||s.underscored(t)+"_id",c="__"+t;n[i]=function(){if(!n[c])if(o.reverseLookup){var i=new e;i.urlRoot=this.url()+"/"+t,n[c]=i}else{var r=n.get(t)||{id:n.get(u)};n[c]=new e(r)}return n[c]},n[r]=function(t){n[c]=t,n.set(u,t.get("id"))}},url:function(){return this.collection?this.collection.url()+"/"+this.get("id"):Backbone.Model.prototype.url.call(this)}},{collection:t.RecordSet,all:function(t){return this.select(t)},select:function(t){var e=new this.collection;return e.lookup=_.extend({},e.lookup,t),e.urlRoot=this.prototype.urlRoot,e.model=this,e},byId:function(e,o){o=o||{};var n=new t.Q("id").is(e);return o.where=n.and(o.where),this.select().fetchOne(o)}})}(window.orb)},{}],3:[function(t,e,o){!function(t){t.Q=Backbone.Model.extend({defaults:{op:"==",column:void 0,table:"",caseSensitive:!1,functions:void 0,math:void 0,inverted:!1,value:void 0},initialize:function(t){"string"==typeof t&&this.set("column",t),void 0===this.get("functions")&&this.set("functions",[]),void 0===this.get("math")&&this.set("math",[])},after:function(e){var o=this.copy();return o.set("op",t.Q.Op.After),o.set("value",e),o},abs:function(){var t=this.copy();return t.modify(this.Function.Abs),t},and:function(e){return void 0===e||e.isNull()?this:this.isNull()?e:new t.QCompound({op:t.Q.Op.And,queries:[this,e]})},asString:function(){var e=this.copy();return e.modify(t.Q.Op.AsString),e},before:function(e){var o=this.copy();return o.set("op",t.Q.Op.Before),o.set("value",e),o},between:function(e,o){var n=this.copy();return n.set("op",t.Q.Op.Between),n.set("value",[e,o]),n},contains:function(e,o){var o=void 0===o?!1:o,n=this.copy();return n.set("op",t.Q.Op.Contains),n.set("value",e),n.set("caseSensitive",o),n},copy:function(){var e=_.extend({},this.attributes);return e.functions=e.functions.slice(0),e.math=e.math.slice(0),new t.Q(e)},doesNotContain:function(e,o){var o=void 0===o?!1:o,n=this.copy();return n.set("op",t.Q.Op.DoesNotContain),n.set("value",e),n.set("caseSensitive",o),n},doesNotMatch:function(e,o){var o=void 0===o?!0:o,n=this.copy();return n.set("op",t.Q.Op.Matches),n.set("value",e),n.set("caseSensitive",o),n},endswith:function(e){var o=this.copy();return o.set("op",t.Q.Op.Endswith),o.set("value",e),o},greaterThan:function(e){var o=this.copy();return o.set("op",t.Q.Op.GreaterThan),o.set("value",e),o},greaterThanOrEqual:function(e){var o=this.copy();return o.set("op",t.Q.Op.GreaterThanOrEqual),o.set("value",e),o},is:function(e){var o=this.copy();return o.set("op",t.Q.Op.Is),o.set("value",e),o},isNot:function(e){var o=this.copy();return o.set("op",t.Q.Op.IsNot),o.set("value",e),o},isNull:function(){return void 0===this.get("column")||void 0===this.get("value")},isUndefined:function(){return void 0===this.get("value")},"in":function(e){var o=this.copy();return o.set("op",t.Q.Op.IsIn),o.set("value",e.slice(0)),o},notIn:function(e){var o=this.copy();return o.set("op",t.Q.Op.IsNotIn),o.set("value",e.slice(0)),o},lessThan:function(e){var o=this.copy();return o.set("op",t.Q.Op.LessThan),o.set("value",e.slice(0)),o},lessThanOrEqual:function(e){var o=this.copy();return o.set("op",t.Q.Op.LessThanOrEqual),o.set("value",e),o},lower:function(){var t=this.copy();t.modify(this.Function.Lower)},matches:function(e,o){var o=void 0===o?!0:o,n=this.copy();return n.set("op",t.Q.Op.Matches),n.set("value",e),n.set("caseSensitive",o),n},modify:function(t){this.get("functions").push(t)},or:function(e){return void 0===e||e.isNull()?this:this.isNull()?e:new t.QCompound({op:t.Q.Op.Or,queries:[this,e]})},startswith:function(e){var o=this.copy();return o.set("op",t.Q.Op.Startswith),o.set("value",e),o},toJSON:function(){var e={type:"query",column:this.get("column"),op:t.Q.Op.key(this.get("op")),value:this.get("value")},o=this.get("functions");if(!_.isEmpty(o)){var n=[];_.each(o,function(e){n.push(t.Q.Function.key(e))}),e.functions=n}var i=this.get("math");if(!_.isEmpty(i)){var r=[];_.each(i,function(e){r.push(t.Q.Math.key(e))}),e.math=r}return e},upper:function(){var t=this.copy();t.modify(this.Funtions.Upper)}},{Op:{Is:"==",IsNot:"!=",LessThan:"<",LessThanOrEqual:"<=",Before:"<",GreaterThan:">",GreaterThanOrEqual:">=",After:">",Between:"between",Contains:"contains",DoesNotContain:"doesn't match",Startswith:"startswith",Endswith:"endswith",Matches:"matches",DoesNotMatch:"doesn't match",IsIn:"is in",IsNotIn:"is not in",DoesNotStartwith:"doesn't startwith",DoesNotEndwith:"doesn't endwith",And:"and",Or:"or",key:function(t){var e=void 0;return _.find(this,function(o,n){return o===t?(e=n,!0):!1}),e}},Math:{Add:"+",Subtract:"-",Multiply:"*",Divide:"/",And:"&",Or:"|",key:function(t){var e=void 0;return _.find(this,function(o,n){return o===t?(e=n,!0):!1}),e}},Function:{Lower:"lower",Upper:"upper",Abs:"abs",AsString:"str",key:function(t){var e=void 0;return _.find(this,function(o,n){return o===t?(e=n,!0):!1}),e}}}),t.QCompound=Backbone.Model.extend({defaults:{op:"And",queries:void 0},initialize:function(t){void 0===this.get("queries")&&this.set("queries",[])},and:function(e){if(void 0===e||e.isNull())return this;if(this.isNull())return e;if(this.get("op")===t.Q.Op.And){var o=this.get("queries").slice(0);return o.push(e),new t.QCompound({op:t.Q.Op.And,queries:o})}return new t.QCompound({op:t.Q.Op.And,queries:[this,e]})},copy:function(){var e={op:this.get("op"),queries:this.get("queries").slice(0)};return new t.QCompound(e)},isNull:function(){var t=!0;return _.each(this.get("queries"),function(e){e.isNull()||(t=!1)}),t},or:function(e){if(void 0===e||e.isNull())return this;if(this.isNull())return e;if(this.get("op")===t.Q.Op.Or){var o=this.get("queries").slice(0);return o.push(e),new t.QCompound({op:t.Q.Op.Or,queries:o})}return new t.QCompound({op:t.Q.Op.Or,queries:[this,e]})},toJSON:function(){var e=[];return _.each(this.get("queries"),function(t){e.push(t.toJSON())}),{type:"compound",op:t.Q.Op.key(this.get("op")),queries:e}}})}(window.orb)},{}],4:[function(t,e,o){!function(t,e){t.RecordSet=Backbone.Collection.extend({initialize:function(){this.lookup={}},copy:function(){var t=new this.constructor;return t.urlRoot=this.urlRoot,t.model=this.model,t.lookup=_.extend({},t.lookup),t.lookup.where&&(t.lookup.where=t.lookup.where.copy()),t.lookup.columns&&(t.lookup.columns=t.lookup.columns.slice(0)),t.lookup.order&&"object"==typeof t.lookup.order&&(t.lookup.order=t.lookup.order.slice(0)),t},fetchCount:function(t){return this.fetch(_.extend({},t,{data:{returning:"count"}}))},fetch:function(t){var t=t||{},e={},o=void 0;return this.lookup.where?o=this.lookup.where.and(t.where):t.where&&(o=t.where),o&&!o.isNull()&&(e.where=o.toJSON()),(t.limit||this.lookup.limit)&&(e.limit=t.limit||this.lookup.limit),(t.order||this.lookup.order)&&(e.order=t.order||this.lookup.order),(t.expand||this.lookup.expand)&&(e.expand=t.expand||this.lookup.expand),_.isEmpty(e)||(t.data=_.extend({lookup:JSON.stringify(e)},t.data)),Backbone.Collection.prototype.fetch.call(this,t)},fetchOne:function(t){t=t||{};var e=_.extend({},t,{limit:1,success:function(e,o){t.success&&(e.length?t.success(e.at(0),o):t.success(void 0,o))}});return this.fetch(e)},refine:function(t){var e=this.copy();return e.lookup.where?e.lookup.where=e.lookup.where.and(t.where):t.where&&(e.lookup.where=t.where),delete t.where,e.lookup=_.extend(e.lookup,t),e},url:function(){var t="string"==typeof this.urlRoot?this.urlRoot:this.urlRoot();return this.lookup.view?s.rtrim(t,"/")+"/"+this.lookup.view:t}})}(window.orb,jQuery)},{}],5:[function(t,e,o){!function(t,e){t.Schema=Backbone.Model.extend({})}(window.orb,jQuery)},{}]},{},[1]);
