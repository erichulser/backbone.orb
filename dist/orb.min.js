!function t(e,n,i){function o(s,u){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(r)return r(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return o(n?n:t)},h,h.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){window.orb={ready:function(t,e,n){$.ajax({url:t,type:"get",jsonp:"callback",dataType:"jsonp",contentType:"application/json",data:{returning:"schema"},success:function(t){_.forEach(t,function(t){console.log(t.name)})}})}},t("./schema"),t("./collection"),t("./model"),t("./queries")},{"./collection":2,"./model":3,"./queries":4,"./schema":5}],2:[function(t,e,n){!function(t,e){t.Collection=Backbone.Collection.extend({initialize:function(){this.context={}},create:function(t,e){e=e||{},e.url=this.url(),Backbone.Collection.prototype.create.call(this,t,e)},copy:function(){var t=new this.constructor;return t.urlRoot=this.urlRoot,t.model=this.model,t.context=_.extend({},this.context),void 0!==this.context.where&&(t.context.where=this.context.where.copy()),void 0!==this.context.columns&&(t.context.columns=this.context.columns.slice(0)),this.context.order&&"object"==typeof this.context.order&&(t.context.order=this.context.order.slice(0)),t},fetchCount:function(t){var e=this.copy();return t.data?t.data.returning="count":t.data={returning:"count"},e.fetch(t)},fetch:function(t){t=t||{};var e={},n=void 0;return this.context.where?n=this.context.where.and(t.where):t.where&&(n=t.where),n&&!n.isNull()&&(e.where=n.toJSON()),(t.limit||this.context.limit)&&(e.limit=t.limit||this.context.limit),(t.order||this.context.order)&&(e.order=t.order||this.context.order),(t.expand||this.context.expand)&&(e.expand=t.expand||this.context.expand),_.isEmpty(e)||(t.data=_.extend({context:JSON.stringify(e)},t.data)),Backbone.Collection.prototype.fetch.call(this,t)},fetchOne:function(t){t=t||{};var e=this.copy(),n=_.extend({},t,{limit:1,success:function(e,n){t.success&&(e.length?t.success(e.at(0),n):t.success(void 0,n))}});return e.fetch(n)},refine:function(t){var e=this.copy();return e.context.where?e.context.where=e.context.where.and(t.where):t.where&&(e.context.where=t.where),delete t.where,e.context=_.extend(e.context,t),e},url:function(){var t="string"==typeof this.urlRoot?this.urlRoot:this.urlRoot();return this.context.view?s.rtrim(t,"/")+"/"+this.context.view:t}})}(window.orb,jQuery)},{}],3:[function(t,e,n){!function(t,e){t.Model=Backbone.Model.extend({initialize:function(t){if(t=t||{},this.schema){var e={};_.each(this.schema.columns||[],function(t){void 0!==t["default"]&&(e[t.field]=t["default"])}),t=_.extend(e,t)}this.references={},Backbone.Model.prototype.initialize.call(this,t)},addCollection:function(t,e,n){n=n||{};var i=this,o=this.get(t),r=_.isEmpty(o)?new e.collection:new e.collection(_.map(o,function(t){new e(t)}));return r.model=e,n.urlRoot?r.urlRoot=n.urlRoot:r.urlRoot=function(){return s.rtrim(i.urlRoot,"/")+"/"+i.get("id")+"/"+(n.urlSuffix||t)},this[t]=r,r},addReference:function(t,e,n){n=n||{};var i=this,o=n.getter||"get"+t[0].toUpperCase()+t.slice(1),r=n.setter||"set"+t[0].toUpperCase()+t.slice(1),u=n.field||s.underscored(t)+"_id";i[o]=function(){if(!i.references[t])if(n.reverseLookup){var o=new e;o.urlRoot=this.url()+"/"+t,i.references[t]=o}else{var r=_.extend({id:i.get(u)},i.get(t));i.references[t]=new e(r)}return i.references[t]},i[r]=function(e){i.references[t]=e,i.set(u,e?e.get("id"):null)}},clearReference:function(t){delete this.references[t]},url:function(){if(this.collection){var t=this.get("id");return t?this.collection.url()+"/"+t:this.collection.url()}return Backbone.Model.prototype.url.call(this)}},{schema:void 0,collection:t.Collection,all:function(t){return this.select(t)},select:function(t){var e=new this.collection;return e.context=_.extend({},e.context,t),e.urlRoot=this.prototype.urlRoot,e.model=this,e},byId:function(e,n){n=n||{};var i=new t.Q("id").is(e);return n.where=i.and(n.where),this.select().fetchOne(n)}})}(window.orb)},{}],4:[function(t,e,n){!function(t){t.Q=Backbone.Model.extend({defaults:{op:"==",column:void 0,table:"",caseSensitive:!1,functions:void 0,math:void 0,inverted:!1,value:void 0},initialize:function(t){"string"==typeof t&&this.set("column",t),void 0===this.get("functions")&&this.set("functions",[]),void 0===this.get("math")&&this.set("math",[])},after:function(e){var n=this.copy();return n.set("op",t.Q.Op.After),n.set("value",e),n},abs:function(){var t=this.copy();return t.modify(this.Function.Abs),t},and:function(e){return void 0===e||e.isNull()?this:this.isNull()?e:new t.QCompound({op:t.Q.Op.And,queries:[this,e]})},asString:function(){var e=this.copy();return e.modify(t.Q.Op.AsString),e},before:function(e){var n=this.copy();return n.set("op",t.Q.Op.Before),n.set("value",e),n},between:function(e,n){var i=this.copy();return i.set("op",t.Q.Op.Between),i.set("value",[e,n]),i},contains:function(e,n){var n=void 0===n?!1:n,i=this.copy();return i.set("op",t.Q.Op.Contains),i.set("value",e),i.set("caseSensitive",n),i},copy:function(){var e=_.extend({},this.attributes);return e.functions=e.functions.slice(0),e.math=e.math.slice(0),new t.Q(e)},doesNotContain:function(e,n){var n=void 0===n?!1:n,i=this.copy();return i.set("op",t.Q.Op.DoesNotContain),i.set("value",e),i.set("caseSensitive",n),i},doesNotEndwith:function(e,n){n=void 0===n?!1:n;var i=this.copy();return i.set("op",t.Q.Op.DoesNotEndwith),i.set("value",e),i.set("caseSensitive",n),i},doesNotMatch:function(e,n){var n=void 0===n?!1:n,i=this.copy();return i.set("op",t.Q.Op.DoesNotMatch),i.set("value",e),i.set("caseSensitive",n),i},doesNotStartwith:function(e,n){n=void 0===n?!1:n;var i=this.copy();return i.set("op",t.Q.Op.DoesNotStartwith),i.set("value",e),i.set("caseSensitive",n),i},endswith:function(e){var n=this.copy();return n.set("op",t.Q.Op.Endswith),n.set("value",e),n},greaterThan:function(e){var n=this.copy();return n.set("op",t.Q.Op.GreaterThan),n.set("value",e),n},greaterThanOrEqual:function(e){var n=this.copy();return n.set("op",t.Q.Op.GreaterThanOrEqual),n.set("value",e),n},is:function(e){var n=this.copy();return n.set("op",t.Q.Op.Is),n.set("value",e),n},isNot:function(e){var n=this.copy();return n.set("op",t.Q.Op.IsNot),n.set("value",e),n},isNull:function(){return void 0===this.get("column")||void 0===this.get("value")},isUndefined:function(){return void 0===this.get("value")},"in":function(e){var n=this.copy();return n.set("op",t.Q.Op.IsIn),n.set("value",e.slice(0)),n},notIn:function(e){var n=this.copy();return n.set("op",t.Q.Op.IsNotIn),n.set("value",e.slice(0)),n},lessThan:function(e){var n=this.copy();return n.set("op",t.Q.Op.LessThan),n.set("value",e.slice(0)),n},lessThanOrEqual:function(e){var n=this.copy();return n.set("op",t.Q.Op.LessThanOrEqual),n.set("value",e),n},lower:function(){var t=this.copy();t.modify(this.Function.Lower)},matches:function(e,n){var n=void 0===n?!0:n,i=this.copy();return i.set("op",t.Q.Op.Matches),i.set("value",e),i.set("caseSensitive",n),i},modify:function(t){this.get("functions").push(t)},or:function(e){return void 0===e||e.isNull()?this:this.isNull()?e:new t.QCompound({op:t.Q.Op.Or,queries:[this,e]})},startswith:function(e){var n=this.copy();return n.set("op",t.Q.Op.Startswith),n.set("value",e),n},toJSON:function(){var e={type:"query",column:this.get("column"),op:t.Q.Op.key(this.get("op")),value:this.get("value")},n=this.get("functions");if(!_.isEmpty(n)){var i=[];_.each(n,function(e){i.push(t.Q.Function.key(e))}),e.functions=i}var o=this.get("math");if(!_.isEmpty(o)){var r=[];_.each(o,function(e){r.push(t.Q.Math.key(e))}),e.math=r}return e},upper:function(){var t=this.copy();t.modify(this.Funtions.Upper)}},{Op:{Is:"==",IsNot:"!=",LessThan:"<",LessThanOrEqual:"<=",Before:"<",GreaterThan:">",GreaterThanOrEqual:">=",After:">",Between:"between",Contains:"contains",DoesNotContain:"doesn't contain",Startswith:"startswith",Endswith:"endswith",Matches:"matches",DoesNotMatch:"doesn't match",IsIn:"is in",IsNotIn:"is not in",DoesNotStartwith:"doesn't startwith",DoesNotEndwith:"doesn't endwith",And:"and",Or:"or",key:function(t){var e=void 0;return _.find(this,function(n,i){return n===t?(e=i,!0):!1}),e}},Math:{Add:"+",Subtract:"-",Multiply:"*",Divide:"/",And:"&",Or:"|",key:function(t){var e=void 0;return _.find(this,function(n,i){return n===t?(e=i,!0):!1}),e}},Function:{Lower:"lower",Upper:"upper",Abs:"abs",AsString:"str",key:function(t){var e=void 0;return _.find(this,function(n,i){return n===t?(e=i,!0):!1}),e}}}),t.QCompound=Backbone.Model.extend({defaults:{op:"And"},initialize:function(e){e=e||{},this.queries=e.queries||new t.Collection},and:function(e){if(void 0===e||e.isNull())return this;if(this.isNull())return e;if(this.get("op")===t.Q.Op.And){var n=this.queries.slice(0);return n.push(e),new t.QCompound({op:t.Q.Op.And,queries:n})}return new t.QCompound({op:t.Q.Op.And,queries:new Backbone.Collection([this,e])})},copy:function(){var e={op:this.get("op"),queries:this.queries.slice(0)};return new t.QCompound(e)},isNull:function(){var t=!0;return _.each(this.queries,function(e){e.isNull()||(t=!1)}),t},or:function(e){if(void 0===e||e.isNull())return this;if(this.isNull())return e;if(this.get("op")===t.Q.Op.Or){var n=this.queries.slice(0);return n.push(e),new t.QCompound({op:t.Q.Op.Or,queries:n})}return new t.QCompound({op:t.Q.Op.Or,queries:[this,e]})},toJSON:function(){return{type:"compound",op:t.Q.Op.key(this.get("op")),queries:this.queries.toJSON()}}})}(window.orb)},{}],5:[function(t,e,n){!function(t,e){t.Index=Backbone.Model.extend({defaults:{name:"",dbname:"",unique:!1,order:void 0,cached:!1,timeout:0},initialize:function(){this.columns=new Backbone.Collection({model:t.Column})},toJSON:function(){return{name:this.get("name"),dbname:this.get("dbname"),unique:this.get("unique"),order:this.get("order"),cached:this.get("cached"),timeout:this.get("timeout")}}}),t.Pipe=Backbone.Model.extend({defaults:{name:"",through:"",from:"",to:"",unique:!1},toJSON:function(){return{name:this.get("name"),through:this.get("through"),from:this.get("from"),to:this.get("to"),unique:this.get("unique")}}}),t.Column=Backbone.Model.extend({defaults:{type:"",name:"",field:"",display:"",reference:void 0,index:void 0,flags:0,"default":void 0,defaultOrder:"asc"},testFlag:function(t){return(self.get("flags")&t)>0},toJSON:function(){var t=this.get("index"),e=void 0;return t&&(e={name:t.get("name"),cached:t.get("cached"),timeout:t.get("timeout")}),{type:this.get("type"),name:this.get("name"),field:this.get("field"),display:this.get("display"),flags:this.get("flags"),defaultOrder:this.get("defaultOrder"),"default":this.get("default"),index:e}}},{Flags:{ReadOnly:Math.pow(2,0),Private:Math.pow(2,1),Polymorphic:Math.pow(2,2),Primary:Math.pow(2,3),Autoincrement:Math.pow(2,4),Required:Math.pow(2,5),Unique:Math.pow(2,6),Encrypted:Math.pow(2,7),Searchable:Math.pow(2,8),Translatable:Math.pow(2,9),CaseSensitive:Math.pow(2,10),Virtual:Math.pow(2,11),Queryable:Math.pow(2,12)}}),t.Schema=Backbone.Model.extend({defaults:{name:"","abstract":!1,dbname:"",display:"",inherits:"",type:""},initialize:function(){this.columns=new Backbone.Collection,this.columns.comparator=function(t){return t.get("name")},this.indexes=new Backbone.Collection,this.indexes.comparator=function(t){return t.get("name")},this.pipes=new Backbone.Collection,this.pipes.comparator=function(t){return t.get("name")}},toJSON:function(){return{name:this.get("name"),"abstract":this.get("abstract"),dbname:this.get("dbname"),display:this.get("display"),inherits:this.get("inherits"),columns:this.columns.toJSON(),indexes:this.indexes.toJSON(),pipes:this.pipes.toJSON()}}})}(window.orb,jQuery)},{}]},{},[1]);
